# Issue #16: キーボードショートカットの追加

## 概要
ウィンドウ操作のためのキーボードショートカットを追加しました。

## 実装内容

### 1. Ctrl+N: 新規ウィンドウを開く
- **機能**: 新しいエディタウィンドウを開く
- **既存実装**: 既に `NewCommand` として実装済み
- **動作**: 新しい `MainWindow` インスタンスを作成して表示

### 2. Ctrl+W: ウィンドウを閉じる
- **機能**: 現在のウィンドウを閉じる
- **新規実装**: `CloseCommand` を追加
- **動作**:
  - `Close()` メソッドを呼び出してウィンドウを閉じる
  - `Window_Closing` イベントが自動的に発火
  - 未保存の変更がある場合は確認ダイアログが表示される

## 変更ファイル

### MainWindow.xaml
- **変更箇所**: `Window.InputBindings` セクション
- **追加内容**:
  ```xml
  <KeyBinding Key="W" Modifiers="Control" Command="{Binding CloseCommand}" />
  ```

### MainWindow.xaml.cs
- **追加コマンド**: `CloseCommand` プロパティ
- **追加メソッド**: `CloseWindow()`
  ```csharp
  private void CloseWindow()
  {
      // Close() を呼び出すと Window_Closing イベントが発火するため、
      // 未保存の変更がある場合は自動的に確認ダイアログが表示される
      Close();
  }
  ```
- **コマンド初期化**: コンストラクタで `CloseCommand = new RelayCommand(CloseWindow);` を追加

## 動作詳細

### Ctrl+N の動作フロー
1. `NewCommand` が実行される
2. `NewFile()` メソッドが呼ばれる
3. 新しい `MainWindow` インスタンスが作成され、`Show()` で表示

### Ctrl+W の動作フロー
1. `CloseCommand` が実行される
2. `CloseWindow()` メソッドが呼ばれる
3. `Close()` メソッドが実行される
4. `Window_Closing` イベントハンドラが発火
5. 未保存の変更がある場合 (`_isModified == true`)：
   - `ConfirmSave()` が呼ばれる
   - 確認ダイアログが表示される
   - ユーザーの選択に応じて保存/破棄/キャンセル
6. ウィンドウが閉じる（キャンセルした場合は閉じない）

## テスト項目

### Ctrl+N のテスト
- [ ] Ctrl+N を押して新しいウィンドウが開くことを確認
- [ ] 複数のウィンドウを同時に開けることを確認
- [ ] 各ウィンドウが独立して動作することを確認

### Ctrl+W のテスト
- [ ] Ctrl+W を押してウィンドウが閉じることを確認
- [ ] 未保存の変更がある場合に確認ダイアログが表示されることを確認
- [ ] 確認ダイアログで「はい」を選択すると保存されてウィンドウが閉じることを確認
- [ ] 確認ダイアログで「いいえ」を選択すると保存せずにウィンドウが閉じることを確認
- [ ] 確認ダイアログで「キャンセル」を選択するとウィンドウが閉じないことを確認
- [ ] 保存済みのファイルの場合は確認なしでウィンドウが閉じることを確認

## 既存機能との整合性

### ウィンドウの閉じる動作
- Alt+F4（Windows標準）でも同じ動作
- タイトルバーの×ボタンでも同じ動作
- すべて `Window_Closing` イベントを経由するため、一貫した動作を保証

### ファイル操作の一貫性
- Ctrl+N: 新規ウィンドウ
- Ctrl+O: ファイルを開く
- Ctrl+S: 保存
- Ctrl+W: ウィンドウを閉じる

これらのショートカットは Windows の標準的なキーバインドに準拠しています。

## 実装日
2025-11-11

## 関連Issue
- Issue #16: キーボードショートカットの追加
